---
import { getCollection, render } from "astro:content";
import { Image } from "astro:assets";
import type { Product } from "../../content.config";
import Layout from "../../layouts/Layout.astro";
import HeaderProductsPage from "../../components/HeaderProductsPage.tsx";

export async function getStaticPaths() {
   const products = await getCollection("products");
   return products.map((product) => ({
      params: { product: product.id },
      props: { product },
   }));
}
const products = await getCollection("products");
const { product } = Astro.props;
const { Content } = await render(product);
const { id, body } = product;
const {
   title,
   mainImg,
   supplier,
   description,
   images,
   variants,
   fullDescription,
} = product.data;
---

<Layout title={title}>
   <HeaderProductsPage client:load products={products} />
   <main
      class="mt-20 mb-10 w-2/3 mx-auto flex flex-col md:flex-row justify-center bg-white p-10 rounded-md shadow-lg"
   >
      <section>
         <Image
            src={`/img/main/${mainImg}`}
            alt={`Imagen ${title}`}
            width={300}
            height={300}
            class="rounded-md md:w-4/5 md:max-w-7xl"
         />
      </section>
      <section class="w-full mx-auto">
         <h1 class="text-7xl font-bold">
            {title}
            <span class="text-2xl text-gray-500 mb-1">{supplier}</span>
         </h1>
         <article>
            <p class="mb-5">{description}</p>
            {fullDescription}
         </article>
         <!-- <div class="flex justify-center">
            {
               images.map((img) => (
                  <Image
                     src={`/img/products/${img}`}
                     alt={`Imagen ${title}`}
                     width={300}
                     height={300}
                     class="rounded-md w-1/3 mx-auto"
                  />
               ))
            }
         </div> -->
      </section>
   </main>
</Layout>
